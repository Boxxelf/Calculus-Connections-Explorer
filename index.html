<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculus Concept Map</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="instructions-overlay" class="instructions-overlay">
        <div class="instructions-modal">
            <button type="button" id="instructions-close" class="instructions-close" aria-label="Close instructions">&times;</button>
            <h2>How to Use the Calculus Concept Map</h2>
            <p class="instructions-tagline">Discover how computer science topics connect to calculus concepts.</p>
            <ol class="instructions-steps">
                <li><strong>Select CS topics:</strong> Use the list under "CS Topics" to highlight related calculus nodes. A red glow indicates stronger connections.</li>
                <li><strong>Browse the course hierarchy:</strong> Expand items under "Calculus Courses" to locate specific topics and spotlight them within the map.</li>
                <li><strong>Inspect details:</strong> Click any calculus node to view filtered rationales that match the currently selected CS topics. Incoming prerequisite nodes stay highlighted, while outgoing nodes fade.</li>
                <li><strong>Multi-course insights:</strong> When all courses are selected, node size scales with total connections so key topics stand out.</li>
                <li><strong>Navigating the map:</strong> The full graph is visible on load. Interactions trigger smart zooming; you can also drag and scroll to adjust the view manually.</li>
            </ol>
            <div class="instructions-actions">
                <button type="button" id="instructions-dismiss" class="primary-btn">Start Exploring</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="sidebar-left">
            <div class="sidebar-header">
                <h2>Explore</h2>
                <button type="button" id="instructions-open" class="instructions-button">Instructions</button>
            </div>

            <div class="sidebar-section">
                <h3>CS Topics</h3>
                <div id="cs-topic-tree" class="cs-topic-tree">
                    <!-- CS topics will be inserted here -->
                </div>
                <button type="button" id="cs-topic-clear" class="tertiary-btn">Clear CS Selection</button>
            </div>

            <div class="sidebar-section">
                <h3>Calculus Courses</h3>
                <div id="calculus-tree" class="calculus-tree">
                    <!-- Calculus hierarchy will be inserted here -->
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="main-header">
                <h1>Calculus Concept Map</h1>
                <div id="course-selection-summary" class="course-selection-summary"></div>
            </div>
            <div class="chart-container">
                <svg id="chart"></svg>
            </div>
        </div>
        
        <div class="sidebar-right">
            <div id="rationale-display" class="hidden">
                <h3>Details</h3>
                <h4 id="rationale-title"></h4>
                <p id="rationale-level"></p>
                <div id="rationale-content"></div>
            </div>

            <div id="empty-selection" class="empty-state">
                <h3>Select a Calculus Topic</h3>
                <p>Click any node in the visualization or in the hierarchy to view rationales that match the active CS topic filters.</p>
            </div>
        </div>
    </div>

    <div class="tooltip" style="opacity:0;"></div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="app.js?v=20"></script>
</body>
</html>